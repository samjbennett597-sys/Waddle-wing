<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Waddle Wings</title>

  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#2C3E50">

  <style>
    @import url("https://fonts.googleapis.com/css2?family=Fredoka+One&display=swap");

    * { box-sizing: border-box; }

    body {
      margin: 0;
      padding: 0;
      background: #111;
      font-family: "Fredoka One", cursive;
      overflow: hidden;
      touch-action: none;
    }

    #game-container {
      position: absolute;
      inset: 0;
      overflow: hidden;
    }

    canvas {
      display: block;
    }

    /* FLOATING MENU */
    #menu {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0,0,0,0.55);
      padding: 25px 40px;
      text-align: center;
      border-radius: 20px;
      border: 2px solid rgba(255,255,255,0.25);
      box-shadow: 0 10px 25px rgba(0,0,0,0.5);
      backdrop-filter: blur(5px);
      animation: fadeIn 0.4s ease-out;
      z-index: 50;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translate(-50%, -55%); }
      to { opacity: 1; transform: translate(-50%, -50%); }
    }

    #menu h1 {
      margin: 0 0 15px;
      font-size: 2.5rem;
      color: #fff;
      text-shadow: 3px 3px 6px #000;
    }

    .menu-btn {
      background: #ff6b6b;
      border: none;
      padding: 14px 40px;
      margin: 10px 0;
      color: white;
      font-size: 1.3rem;
      border-radius: 40px;
      box-shadow: 0 4px 0 #c04444;
      cursor: pointer;
      width: 200px;
    }

    .menu-btn:active {
      transform: translateY(3px);
      box-shadow: 0 1px 0 #c04444;
    }

    /* ICON BAR */
    #icon-bar {
      position: absolute;
      bottom: 18px;
      right: 18px;
      display: flex;
      gap: 14px;
      font-size: 1.8rem;
      z-index: 60;
    }

    .ibtn {
      color: #fff;
      opacity: 0.75;
      cursor: pointer;
      transition: 0.15s;
    }

    .ibtn:hover { opacity: 1; }

    /* STORE */
    #store {
      position: absolute;
      inset: 0;
      background: rgba(0,0,0,0.7);
      backdrop-filter: blur(6px);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 100;
    }

    #store-card {
      background: rgba(15,20,45,0.95);
      padding: 25px;
      width: 90%;
      max-width: 360px;
      border-radius: 20px;
      border: 2px solid #2C3E50;
      color: white;
      text-align: center;
    }

    #store-card h2 { margin-top: 0; }

    .store-item {
      display: flex;
      justify-content: space-between;
      padding: 10px 0;
      border-bottom: 1px solid rgba(255,255,255,0.1);
    }

    .store-btn {
      background: #6078ea;
      border: none;
      color: #fff;
      padding: 6px 14px;
      border-radius: 8px;
      cursor: pointer;
    }

    #close-store {
      margin-top: 14px;
      background: #ff6b6b;
      border: none;
      padding: 10px 20px;
      border-radius: 12px;
      color: #fff;
      cursor: pointer;
    }

    /* SCORE DISPLAY */
    #score {
      position: absolute;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 3rem;
      color: white;
      text-shadow: 3px 3px 6px rgba(0,0,0,0.5);
      z-index: 20;
      display: none;
    }
  </style>
</head>
<body>

<div id="game-container">
  <canvas id="game"></canvas>

  <div id="score">0</div>

  <!-- FLOATING MENU -->
  <div id="menu">
    <h1>WADDLE WINGS</h1>
    <button id="playBtn" class="menu-btn">PLAY</button>
    <button id="storeBtn" class="menu-btn">STORE</button>
  </div>

  <!-- ICONS -->
  <div id="icon-bar">
    <div class="ibtn" id="settingsBtn">⚙</div>
    <div class="ibtn" id="infoBtn">ℹ</div>
  </div>

  <!-- STORE PANEL -->
  <div id="store">
    <div id="store-card">
      <h2>STORE</h2>

      <div class="store-item">
        <span>Remove Ads</span>
        <button class="store-btn">£4.99</button>
      </div>

      <div class="store-item">
        <span>Double Coins</span>
        <button class="store-btn">£3.99</button>
      </div>

      <div class="store-item">
        <span>Starter Pack</span>
        <button class="store-btn">£2.49</button>
      </div>

      <button id="close-store">Close</button>
    </div>
  </div>
</div>

<script>
/* CANVAS SETUP */
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

function resize() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
window.addEventListener("resize", resize);
resize();

/* GAME STATE */
let penguin = { x: 0, y: 0, vel: 0, r: 18 };
let pipes = [];
let score = 0;
let running = false;
let started = false;

/* DIFFICULTY */
let pipeGap = 160;
let pipeSpeed = 3;

/* RESET GAME */
function resetGame() {
  penguin.x = canvas.width * 0.25;
  penguin.y = canvas.height / 2;
  penguin.vel = 0;

  pipes = [];
  score = 0;
  started = false;
  pipeGap = 160;
  pipeSpeed = 3;

  document.getElementById("score").style.display = "none";
}

/* START RUN */
document.getElementById("playBtn").onclick = () => {
  document.getElementById("menu").style.display = "none";
  document.getElementById("score").style.display = "block";
  running = true;
  resetGame();
};

/* STORE */
document.getElementById("storeBtn").onclick = () => {
  document.getElementById("store").style.display = "flex";
};
document.getElementById("close-store").onclick = () => {
  document.getElementById("store").style.display = "none";
};

/* GAME LOOP */
let frame = 0;
function loop() {
  if (!running) return requestAnimationFrame(loop);

  ctx.clearRect(0,0,canvas.width,canvas.height);

  /* BACKGROUND */
  let grad = ctx.createLinearGradient(0,0,0,canvas.height);
  grad.addColorStop(0, "#87CEEB");
  grad.addColorStop(1, "#E0F7FA");
  ctx.fillStyle = grad;
  ctx.fillRect(0,0,canvas.width,canvas.height);

  /* PENGUIN HOVER BEFORE START */
  if (!started) {
    penguin.y = canvas.height/2 + Math.sin(frame*0.08)*10;
  } else {
    penguin.vel += 0.25;
    penguin.y += penguin.vel;

    if (penguin.y + penguin.r > canvas.height) {
      endGame();
    }
  }

  /* DRAW PENGUIN */
  ctx.fillStyle = "#2C3E50";
  ctx.beginPath();
  ctx.ellipse(penguin.x,penguin.y,20,25,0,0,Math.PI*2);
  ctx.fill();

  /* PIPES */
  if (frame % 110 === 0 && started) {
    let top = Math.random() * (canvas.height - pipeGap - 100) + 50;
    pipes.push({ x: canvas.width, y: top });
  }

  for (let i = pipes.length-1; i>=0; i--) {
    let p = pipes[i];

    p.x -= pipeSpeed;

    /* collision */
    if (penguin.x + penguin.r > p.x &&
        penguin.x - penguin.r < p.x + 60) {

      if (penguin.y - penguin.r < p.y ||
          penguin.y + penguin.r > p.y + pipeGap) {
        endGame();
      }
    }

    /* scored */
    if (!p.scored && p.x + 60 < penguin.x) {
      score++;
      p.scored = true;

      /* PROGRESSIVE DIFFICULTY */
      if (score % 10 === 0) pipeSpeed += 0.3;
      if (score % 15 === 0) pipeGap -= 4;
    }

    /* draw pipes */
    ctx.fillStyle = "#a8f2ff";
    ctx.fillRect(p.x, 0, 60, p.y);
    ctx.fillRect(p.x, p.y+pipeGap, 60, canvas.height - (p.y+pipeGap));

    if (p.x < -60) pipes.splice(i,1);
  }

  /* SCORE */
  document.getElementById("score").textContent = score;

  frame++;
  requestAnimationFrame(loop);
}
requestAnimationFrame(loop);

/* INPUT */
function flap() {
  if (!running) return;
  if (!started) started = true;
  penguin.vel = -5.5;
}
window.addEventListener("mousedown", flap);
window.addEventListener("touchstart", flap);

/* END GAME */
function endGame() {
  running = false;
  setTimeout(() => {
    document.getElementById("menu").style.display = "block";
    document.getElementById("score").style.display = "none";
  }, 500);
}
</script>

</body>
</html>
